<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="React"><meta name="keywords" content><meta name="author" content="Smiley"><meta name="copyright" content="Smiley"><title>React | Smiley</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#React"><span class="toc-number">1.</span> <span class="toc-text">React</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup"><span class="toc-number">1.1.</span> <span class="toc-text">Setup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装Node-JS"><span class="toc-number">1.1.1.</span> <span class="toc-text">安装Node.JS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JS基础"><span class="toc-number">1.1.2.</span> <span class="toc-text">JS基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#引入bootstrap-同理引用第三方库"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">引入bootstrap(同理引用第三方库)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-JSX语法"><span class="toc-number">1.1.3.</span> <span class="toc-text">React JSX语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#渲染列表"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">渲染列表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#有条件渲染"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">有条件渲染</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#更新状态"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">更新状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#如何发起及处理事件-Raise-and-Handle-Eve"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">如何发起及处理事件 Raise and Handle Eve</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#组件间传递数据-Pass-Data"><span class="toc-number">1.1.3.5.</span> <span class="toc-text">组件间传递数据 Pass Data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#多组件保存同步-Multiple-Components-in-Sync"><span class="toc-number">1.1.3.6.</span> <span class="toc-text">多组件保存同步 Multiple Components in Sync</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#功能性组件-Functional-Components"><span class="toc-number">1.1.3.7.</span> <span class="toc-text">功能性组件 Functional Components</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#生命周期钩子-Lifecycle-Hooks"><span class="toc-number">1.1.3.8.</span> <span class="toc-text">生命周期钩子 Lifecycle Hooks</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#loadsh库"><span class="toc-number">1.1.3.9.</span> <span class="toc-text">loadsh库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#类型检测"><span class="toc-number">1.1.3.10.</span> <span class="toc-text">类型检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#props默认值"><span class="toc-number">1.1.3.11.</span> <span class="toc-text">props默认值</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Routing-and-Navigation"><span class="toc-number">1.2.</span> <span class="toc-text">Routing and Navigation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#安装"><span class="toc-number">1.2.0.0.1.</span> <span class="toc-text">安装</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-String"><span class="toc-number">1.2.1.</span> <span class="toc-text">Query String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redirect-amp-amp-Not-Found-404-Pages"><span class="toc-number">1.2.2.</span> <span class="toc-text">Redirect  &amp;&amp;  Not Found(404) Pages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nested-Rounting"><span class="toc-number">1.2.3.</span> <span class="toc-text">Nested Rounting</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#Form"><span class="toc-number">1.3.</span> <span class="toc-text">Form</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Handing-Form-Submission—处理表单的提交行为"><span class="toc-number">1.3.1.</span> <span class="toc-text">Handing Form Submission—处理表单的提交行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Validation——验证"><span class="toc-number">1.3.2.</span> <span class="toc-text">Validation——验证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Joi第三方库"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Joi第三方库</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Calling-Backend-Services"><span class="toc-number">1.3.3.</span> <span class="toc-text">Calling Backend Services</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#JSONPlaceholder-——伪造的后端-——JSON占位器"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">JSONPlaceholder ——伪造的后端 ——JSON占位器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CRUD"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">CRUD</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Getting-Data"><span class="toc-number">1.3.3.2.1.</span> <span class="toc-text">Getting Data</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Creating-Data"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">Creating Data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Updating-Data"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">Updating Data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Deleting-Data"><span class="toc-number">1.3.3.5.</span> <span class="toc-text">Deleting Data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axios拦截器"><span class="toc-number">1.3.3.6.</span> <span class="toc-text">Axios拦截器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#sentry-io-记录错误日志-ch8-15"><span class="toc-number">1.3.3.6.1.</span> <span class="toc-text">sentry.io:记录错误日志 ch8-15</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#认证和授权"><span class="toc-number">1.3.4.</span> <span class="toc-text">认证和授权</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-Web-Tokens-JSON网络令牌"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">JSON Web Tokens JSON网络令牌</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Calling-Protected-APIs-请求受保护的终端API"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">Calling Protected APIs 请求受保护的终端API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Showing-Hiding-Elements-根据用户权限展现和隐藏页面元素"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">Showing/Hiding Elements 根据用户权限展现和隐藏页面元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Protecting-Routes-保护路由机制-用户不能在无权限的情况下访问特定网页"><span class="toc-number">1.3.4.4.</span> <span class="toc-text">Protecting Routes 保护路由机制 :用户不能在无权限的情况下访问特定网页</span></a></li></ol></li></ol></li></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://cn.bing.com/th?id=OIP.GGMMu1oe3Cqby3tKJJ6DcgHaHW&amp;pid=Api&amp;rs=1"></div><div class="author-info__name text-center">Smiley</div><div class="author-info__description text-center">Personal Blog</div><div class="follow-button"><a href="https://github.com/Wsmiley">Follw Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">10</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">2</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(http://img18.3lian.com/d/file/201709/14/fbf49f60bc1912277ca0aa46db1499e0.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Smiley</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">React</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-07-19</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="React"><a href="#React" class="headerlink" title="React"></a>React</h1><blockquote>
<p>学习React的一些笔记</p>
</blockquote>
<hr>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><h3 id="安装Node-JS"><a href="#安装Node-JS" class="headerlink" title="安装Node.JS"></a>安装Node.JS</h3><p>作为内置工具&gt;Node包管理&gt;npm&gt;安装第三方库</p>
<p>访问<strong>nodejs.org</strong>安装</p>
<pre><code>npm -i(代表的是install) -g(代表全局) creat-react-app</code></pre><p>webpack&gt;打包代码</p>
<p>Babel&gt;转译器转换代码</p>
<hr>
<h3 id="JS基础"><a href="#JS基础" class="headerlink" title="JS基础"></a>JS基础</h3><p>map()函数</p>
<p>Arrow function函数</p>
<pre><code>析构
const address={
    street:&apos;&apos;,
    city:&apos;&apos;,
    country:&apos;&apos;,
}

const street=address.street;
const city=address.city;
const country=address.country;

==const {street,city,county}=address;

若想使用其他常量
const {street:st}=address;</code></pre><p>展开操作符 ‘…’</p>
<h4 id="引入bootstrap-同理引用第三方库"><a href="#引入bootstrap-同理引用第三方库" class="headerlink" title="引入bootstrap(同理引用第三方库)"></a>引入bootstrap(同理引用第三方库)</h4><pre><code>npm i bootstrap
import &apos;bootstarp/dist/css/boostrap.css&apos;</code></pre><hr>
<h3 id="React-JSX语法"><a href="#React-JSX语法" class="headerlink" title="React JSX语法"></a>React JSX语法</h3><p>render():渲染&gt;调用React.createElement(参数),所以render里面只有一个顶级元素</p>
<p>state:是react组件中一个特殊的属性,它包含了这个组件需要用到的数据。</p>
<h4 id="渲染列表"><a href="#渲染列表" class="headerlink" title="渲染列表"></a>渲染列表</h4><pre><code>{this,state,tags.map(tag=&gt;&lt;li&gt;{tag}&lt;/li&gt;)}</code></pre><p><strong>注意，列表需要设置key属性,且在列表唯一</strong></p>
<h4 id="有条件渲染"><a href="#有条件渲染" class="headerlink" title="有条件渲染"></a>有条件渲染</h4><pre><code>function(){
    if(this.state.)return ;

}

render(){
    return &lt;div&gt;{this.function()}&lt;/div&gt;
}</code></pre><p>js中的 &amp;&amp;表达式 看第一个表达式为真,看第二个表达式,若不为布尔表达式，JS编译器尝试转换成类真/类假值,空字符串被视为类假的,一个非空的字符串视为类真的,返回第二个类真值</p>
<pre><code>function(){
    statement...
    this指代的对象不同,无法直接访问this.state
    可以用在constructor中this.function.bind(this)方法绑定this

    第二个方法使用箭头函数：不会重新绑定this，而是继承它
}

function=()=&gt;{
    可以引用this
}</code></pre><h4 id="更新状态"><a href="#更新状态" class="headerlink" title="更新状态"></a>更新状态</h4><p>this.setState():传入一个对象,对象的属性会与state中的合并或者当state中有相同的属性，就会被覆盖掉</p>
<h4 id="如何发起及处理事件-Raise-and-Handle-Eve"><a href="#如何发起及处理事件-Raise-and-Handle-Eve" class="headerlink" title="如何发起及处理事件 Raise and Handle Eve"></a>如何发起及处理事件 Raise and Handle Eve</h4><p>事件点击</p>
<pre><code>function=()=&gt;{
    statement;
}    
onClick={()=&gt;this.function()}

删除一个内容,新建一个数组,包括所有原数组的内容,除了删除按个
const xxx=this.state.xxx.filter(m=&gt;m._id!==movie_id)
this.setState({xxx:xxx})
新传入的xxx数组会覆盖原来的数组</code></pre><h4 id="组件间传递数据-Pass-Data"><a href="#组件间传递数据-Pass-Data" class="headerlink" title="组件间传递数据 Pass Data"></a>组件间传递数据 Pass Data</h4><p>每个组件都有一个叫props属性，属于JS对象，它会拥有向某组件<strong>传递</strong>的所有属性</p>
<p>传递子元素<br>    <element><br>    <x></x><br>    </element><br>在element组件中可以使用{this.props.children}引用</p>
<h4 id="多组件保存同步-Multiple-Components-in-Sync"><a href="#多组件保存同步-Multiple-Components-in-Sync" class="headerlink" title="多组件保存同步 Multiple Components in Sync"></a>多组件保存同步 Multiple Components in Sync</h4><p>prop和State区别 </p>
<ul>
<li>props是我们给组件的数据(<strong>只读</strong>)</li>
<li>state是组件本地或者私有的数据容器(只能给本地组件访问)</li>
</ul>
<p>受控组件：没有自己的state 所有数据来源props,数据需要改变时发起事件。<br>onClick={()=&gt;this.props.function()}</p>
<h4 id="功能性组件-Functional-Components"><a href="#功能性组件-Functional-Components" class="headerlink" title="功能性组件 Functional Components"></a>功能性组件 Functional Components</h4><p>无状态功能性组件 Stateless Functional Components</p>
<ul>
<li>只有返回方法的组件</li>
<li>没有事件句柄</li>
<li>没有state,只从props获取数据 </li>
</ul>
<p>可以不使用类定义而使用函数，若要使用props数据，把props当做参数传递即可<br>const function=(props)=&gt;{<br>    statement;<br>    return();<br>}</p>
<h4 id="生命周期钩子-Lifecycle-Hooks"><a href="#生命周期钩子-Lifecycle-Hooks" class="headerlink" title="生命周期钩子 Lifecycle Hooks"></a>生命周期钩子 Lifecycle Hooks</h4><p>mounting状态(装载阶段)有3个生命钩子</p>
<ul>
<li><p>constructor:必须调用super();当一个类的实例创建的时候调用,一般给属性赋值;把state设置为props某些属性</p>
</li>
<li><p>render</p>
</li>
<li><p>componentDidMount:Ajax与服务器通信</p>
</li>
</ul>
<p>update状态(state或者组件的props改变时发生)</p>
<ul>
<li>render</li>
<li>componentDidUpdate</li>
</ul>
<p>unmounting状态(卸载阶段)(组件从DOM中移除)</p>
<ul>
<li>componentWillUnmount</li>
</ul>
<h4 id="loadsh库"><a href="#loadsh库" class="headerlink" title="loadsh库"></a>loadsh库</h4><p>import _ from ‘lodash’ //约定 _ 代表lodash</p>
<h4 id="类型检测"><a href="#类型检测" class="headerlink" title="类型检测"></a>类型检测</h4><p>复用组件使用</p>
<p>安装prop-types库</p>
<pre><code>npm i prop-types</code></pre><p>组件创建一个新的属性,在这个属性中定义类型检测的需求</p>
<pre><code>组件名称.propTypes={
    //一般是props传递过来的值 
    xxx:ProTypes. //后面紧跟的是需要检测的类型(数字,字符串,布尔,数组) xxx析构对象/props传递过来的值
}</code></pre><h4 id="props默认值"><a href="#props默认值" class="headerlink" title="props默认值"></a>props默认值</h4><pre><code>组件名.defaultProps={
    属性:属性值
}</code></pre><hr>
<h2 id="Routing-and-Navigation"><a href="#Routing-and-Navigation" class="headerlink" title="Routing and Navigation"></a>Routing and Navigation</h2><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><pre><code>npm i react-router-dom 

在index.js里
import {BrowserRouter} from &apos;react-route-dom&apos;;
ReactDOM.render(&lt;BrowerRouter&gt;&lt;App/&gt;&lt;/BrowerRouter&gt;,document.getElementById(&quot;root&quot;));
&lt;BrowerRouter&gt;&lt;/BrowerRouter&gt;组件记录了浏览器的历史，并传入各组件树成员

import {Rounte} from &apos;react-route-dom&apos;;
&lt;Route path=&quot;&quot; component={}&gt; //path 指定路由的匹配规则 component 指定组件</code></pre><p>1、在<route>里加入 exact表示这条规则只会在完全匹配的时候起效</route></p>
<p>2、引入import {Switch} from ‘react-route-dom’;</p>
<pre><code>&lt;Switch&gt;会匹配第一条符合的子规则</code></pre><p>&lt; Link &gt;用于取代&lt; a &gt;生成一个链接,to属性</p>
<p>如何传递props。不使用component改用render={(props)=&gt;{&lt;组件名 属性=属性值 &gt;}}</p>
<h3 id="Query-String"><a href="#Query-String" class="headerlink" title="Query String"></a>Query String</h3><p>查询字符串就是在URL中加入?  </p>
<pre><code>npm i query-string  </code></pre><h3 id="Redirect-amp-amp-Not-Found-404-Pages"><a href="#Redirect-amp-amp-Not-Found-404-Pages" class="headerlink" title="Redirect  &amp;&amp;  Not Found(404) Pages"></a>Redirect  &amp;&amp;  Not Found(404) Pages</h3><pre><code>import {Redirect} from &apos;react-router-dom&apos;; //Redirect组件可以重定向网页到另一个页面

&lt;Route path=&quot;/not-found&quot; component={NotFound}&gt; //not-found是自己创建的一个组件
&lt;Redirect to=&quot;/not-found /&gt;

&lt;Redirect from=&quot;message&quot; to=&quot;posts&quot;&gt; //如果用户URL来自message 则跳转到posts</code></pre><h3 id="Nested-Rounting"><a href="#Nested-Rounting" class="headerlink" title="Nested Rounting"></a>Nested Rounting</h3><hr>
<h2 id="Form"><a href="#Form" class="headerlink" title="Form"></a>Form</h2><h3 id="Handing-Form-Submission—处理表单的提交行为"><a href="#Handing-Form-Submission—处理表单的提交行为" class="headerlink" title="Handing Form Submission—处理表单的提交行为"></a>Handing Form Submission—处理表单的提交行为</h3><p>每一个表单都有onSubmit={this.handleSubmit}方法</p>
<pre><code>handleSubmit=e=&gt;{
    e.preventDefault();//阻止事件的默认行为：阻止向服务器提交表单造成整个页面重载
}</code></pre><p>Ref引用(尽量少使用)</p>
<pre><code>xxx = React.createRef();//创建Ref对象
然后在组件中添加ref属性 ref={this.xxx}
在handleSubmit方法中需要操作真实DOM则
const xxx=this.xxx.current.value; //current返回当前的DOM元素 value属性来得到值</code></pre><h3 id="Validation——验证"><a href="#Validation——验证" class="headerlink" title="Validation——验证"></a>Validation——验证</h3><h4 id="Joi第三方库"><a href="#Joi第三方库" class="headerlink" title="Joi第三方库"></a>Joi第三方库</h4><pre><code>npm i joi-browser
import Joi from &apos;joi-browser&apos;;</code></pre><p>定义一个schema对象</p>
<pre><code>schema={
    username:Joi.string().required().label(&apos;Username&apos;),
    password:Joi.string().required().label(&apos;Password&apos;),
};</code></pre><p>调用Joi.validate(this.state.xxx,this.schema,{abortEarly:false})方法,第一个参数是我们想要验证的东西,第二个参数是Schema，{abortEarly:false}</p>
<p>将Joi的结果映射到errors对象中</p>
<pre><code>const result=Joi.validate(this.state.xxx,this.schema,{abortEarly:false});
if(!result.error)return null;

const errors={};
for(let item of result.error.details)
    errors[item.path[0]]=item.message;
return errors;</code></pre><hr>
<h3 id="Calling-Backend-Services"><a href="#Calling-Backend-Services" class="headerlink" title="Calling Backend Services"></a>Calling Backend Services</h3><h4 id="JSONPlaceholder-——伪造的后端-——JSON占位器"><a href="#JSONPlaceholder-——伪造的后端-——JSON占位器" class="headerlink" title="JSONPlaceholder ——伪造的后端 ——JSON占位器"></a>JSONPlaceholder ——伪造的后端 ——JSON占位器</h4><p>一个伪造的在线REST API  应用接口</p>
<p>React中没有向服务器发送HTTP请求的概念,所以可以自由的选择第三方库</p>
<ul>
<li>Fetch API</li>
<li>jQuery AJAX</li>
<li>Axios</li>
</ul>
<blockquote>
<p>npm i axios</p>
</blockquote>
<hr>
<h4 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h4><h5 id="Getting-Data"><a href="#Getting-Data" class="headerlink" title="Getting Data"></a>Getting Data</h5><p>获取数据的最佳数据是在componentDidMount</p>
<pre><code>const promise=axios.get(url)//返回一个promise...一个装载异步操作的对象---异步操作是计划在将来完成的操作

创建promise后它立即进入pending状态--执行成功的resolved状态(success)/执行失败的refused状态(failure)

//promise中有response获取response可以调用promise.then()可以得到异步操作的返回值

可以使用JS中的await关键字
const response=await promise得到异步操作的返回值(返回的是response对象)
**只要用到await关键字，函数前需要加async修饰**</code></pre><h4 id="Creating-Data"><a href="#Creating-Data" class="headerlink" title="Creating Data"></a>Creating Data</h4><p>创建一个对象并将它传给后端</p>
<pre><code>//const obj={}
const promise=axios.post(url,obj);//在创建数据时，要在request的请求体中包含数据内容,返回一个promise
然后得到response//就是服务器返回更新的数据
const response=await promise;
//可以直接const {data:post}=await axios.post(url,obj);//返回值析构出data并重命名为post
//更新
const posts=[post,...this.state.posts];
this.setState({posts});</code></pre><h4 id="Updating-Data"><a href="#Updating-Data" class="headerlink" title="Updating Data"></a>Updating Data</h4><p>axios更新方法有两个分别是</p>
<ul>
<li><p>push:更新所有的属性 </p>
<pre><code>post.title=&quot;UPDATED&quot;;
const {data}=await axios.put(url+&apos;/&apos;+post.id,post);//更新一个特定的，所以需要在url中添加特定的id,第二个参数是更新的内容,put方法传入整个对象  返回一个promise 使用await 获得response</code></pre></li>
<li><p>patch:更新一个或多个属性</p>
<pre><code>post.title=&quot;UPDATED&quot;;
const {data}=awaitaxios.patch(url+&apos;/&apos;+post.id,{title:post.title});//更新一个特定的，所以需要在url中添加特定的id,第二个参数是更新的内容,patch方法传入更新的属性返回一个promise 使用await 获得response</code></pre></li>
</ul>
<p>之后更新视图类似creating data</p>
<h4 id="Deleting-Data"><a href="#Deleting-Data" class="headerlink" title="Deleting Data"></a>Deleting Data</h4><pre><code>await axios.delete(url+&apos;/&apos;+post.id,post)
const posts=this.state.posts.filter(p=&gt;p.id!==post.id)//出来删除的id
this.setState({posts})//更新</code></pre><h4 id="Axios拦截器"><a href="#Axios拦截器" class="headerlink" title="Axios拦截器"></a>Axios拦截器</h4><blockquote>
<p>axios.interceptors.response.use(null,error=&gt;{ </p>
<p>return Promise.reject(error);</p>
<p>})//第一个参数是成功执行，第二个参数是失败时执行,为了catch块得到控制权，返回一个拒绝promise</p>
</blockquote>
<h5 id="sentry-io-记录错误日志-ch8-15"><a href="#sentry-io-记录错误日志-ch8-15" class="headerlink" title="sentry.io:记录错误日志 ch8-15"></a>sentry.io:记录错误日志 ch8-15</h5><hr>
<h3 id="认证和授权"><a href="#认证和授权" class="headerlink" title="认证和授权"></a>认证和授权</h3><h4 id="JSON-Web-Tokens-JSON网络令牌"><a href="#JSON-Web-Tokens-JSON网络令牌" class="headerlink" title="JSON Web Tokens JSON网络令牌"></a>JSON Web Tokens JSON网络令牌</h4><p><strong>保存jwt(JSON网络令牌)</strong><br>每一个浏览器都有一个小型的本地数据库：local database</p>
<blockquote>
<p>localStorage.setItem(key,value)//第一参数是键，第二参数的值-传入jwt</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i jwt-decode //解码库</span><br><span class="line">localStorage.getItem(key)//得到jwt，参数是键</span><br><span class="line">jwt-decode(jwt);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>localStorage.removeItem(key)//删除JWT</p>
</blockquote>
<blockquote>
<p>jwt.io:introdution</p>
</blockquote>
<h4 id="Calling-Protected-APIs-请求受保护的终端API"><a href="#Calling-Protected-APIs-请求受保护的终端API" class="headerlink" title="Calling Protected APIs 请求受保护的终端API"></a>Calling Protected APIs 请求受保护的终端API</h4><h4 id="Showing-Hiding-Elements-根据用户权限展现和隐藏页面元素"><a href="#Showing-Hiding-Elements-根据用户权限展现和隐藏页面元素" class="headerlink" title="Showing/Hiding Elements 根据用户权限展现和隐藏页面元素"></a>Showing/Hiding Elements 根据用户权限展现和隐藏页面元素</h4><h4 id="Protecting-Routes-保护路由机制-用户不能在无权限的情况下访问特定网页"><a href="#Protecting-Routes-保护路由机制-用户不能在无权限的情况下访问特定网页" class="headerlink" title="Protecting Routes 保护路由机制 :用户不能在无权限的情况下访问特定网页"></a>Protecting Routes 保护路由机制 :用户不能在无权限的情况下访问特定网页</h4></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Smiley</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://wsmiley.github.io/2019/07/19/React/">http://wsmiley.github.io/2019/07/19/React/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://wsmiley.github.io">Smiley</a>！</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/07/19/Android笔记/"><i class="fa fa-chevron-left">  </i><span>Android笔记</span></a></div><div class="next-post pull-right"><a href="/2019/07/19/Raspberrypi/"><span>Raspberrypi</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(http://img18.3lian.com/d/file/201709/14/fbf49f60bc1912277ca0aa46db1499e0.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2019 By Smiley</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Hi, welcome to my blog</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>